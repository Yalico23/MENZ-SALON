function iniciarApis(){ConsumirApi(),ApiCitas()}async function ConsumirApi(){try{const t=location.origin+"/api/servicios",e=await fetch(t);mostrarServicios(await e.json())}catch(t){console.log(t)}}function mostrarServicios(t){t.forEach(t=>{const{Id:e,Nombre:n,Precio:o,Activo:i}=t,c=document.createElement("P");c.classList.add("nombre-servicio"),c.textContent=n;const a=document.createElement("P");a.classList.add("precio-servicio"),a.textContent="S/. "+o;const r=document.createElement("DIV");r.classList.add("div-servicio"),r.dataset.idServicio=e,r.onclick=function(){seleccionarServicio(t)},"1"===i&&(r.appendChild(c),r.appendChild(a),document.querySelector("#servicios").appendChild(r))})}async function ApiCitas(){try{const t=location.origin+"/api/citas",e=await fetch(t);mostrarCitas(await e.json())}catch(t){console.log(t)}}function mostrarCitas(t){const e={},n=document.querySelector(".contenido-usuario-cita");t.forEach(t=>{const{Id:o,Fecha:i,Hora:c,cliente:a,servicio:r}=t;if(e[o])e[o].servicios.push(r);else{const t=document.createElement("DIV");t.classList.add("divId-"+o);const s=document.createElement("P");s.textContent=i;const d=document.createElement("P");d.textContent=c;const l=document.createElement("P");l.textContent=a.trim(),t.appendChild(l),t.appendChild(s),t.appendChild(d),e[o]={servicios:[r]},n.appendChild(t)}});for(const t in e){const n=document.querySelector(".divId-"+t);e[t].servicios.forEach(t=>{const e=document.createElement("P");e.innerHTML="&rfisht;"+t,n.appendChild(e)});const o=document.createElement("button");o.classList.add("boton-eliminar"),o.textContent="Eliminar Cita",o.addEventListener("click",()=>{enviarFormulario(t)}),n.appendChild(o)}}function enviarFormulario(t){Swal.fire({title:"Confirmación",text:"¿Estás seguro de que deseas eliminar esta cita?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar",iconColor:"#BD9254"}).then(async e=>{if(e.isConfirmed){const e=new FormData;e.append("Id",t);try{const t=location.origin+"/api/citas-eliminar",n=await fetch(t,{method:"POST",body:e});(await n.json()).resultado&&setTimeout(()=>{window.location.reload(),window.location.href=location.origin+"/cita"},1500)}catch(t){console.log(t)}}})}document.addEventListener("DOMContentLoaded",(function(){iniciarApis()}));